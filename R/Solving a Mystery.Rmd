---
title: "Finding the Zodiac Killer and Mapping China"
author: "Michael Cao"
date: "16 April 2023"
output: 
  pdf_document:
    latex_engine: xelatex
---

```{r setup, tidy=TRUE, include=FALSE}
pacman::p_load(knitr, tidyverse, sp)
knitr::opts_chunk$set(echo = TRUE)
```

# Finding the Zodiac Killer

## Loading Packages and Importing Data

We will use the `lubridate` function in this analysis and we will need to load our list of suspects.

```{r}
pacman::p_load(lubridate)
suspects <- read_csv("./suspect_times.csv")
```

## Using Data and What We Know

Given that we know the following information, we can use these to find out the primary Zodiac Killer suspect:

-   Based on the sunburn patterns on the body, the murder was not committed in the morning.
-   The room where the murder was committed is closed Tuesdays and Thursdays, so the murder did not happen on those days.
-   It is believed that the murder was committed within 5 weeks (35 days) of Thanksgiving, 2018.
-   The Killer left behind a birthday card at the scene of the crime. The date is smudged, but the number of the month is shown to be 22. It is thought that perhaps this murder took place less than two days after the Killer's birthday.
-   The Killer him/herself is amused by our efforts, and he has sent us a cryptic clue: "The number of minutes between Jan 1, 1970 at midnight and the time I arrived on the scene is divisible by 10."

```{r}
suspect_final <- suspects %>%
  
  # Exclude suspects who entered at morning
  subset(hour(Time.Spotted)>12) %>% 
  
  # Exclude suspects who entered on Tuesday or Thursday.
  filter(!wday(Time.Spotted, week_start = getOption("lubridate.week.start", 1)) %in% c(2,4)) %>%
  
  # Only keep suspects who entered in 35 days after Thanksgiving of 2018
  subset(date(Time.Spotted)>=as.Date("2018-11-22") & 
           date(Time.Spotted)<=as.Date("2018-11-22")+35) %>% 
  
  # Filter out suspects who didn't enter within two days of the killer's birthday.
  subset(day(Time.Spotted)>=22&day(Time.Spotted)<=24) %>% 
  
  # The Killer's clue
  subset(as.integer((Time.Spotted-as.POSIXlt("1970-01-01 00:00"))
                    *24*60)%%10==0) 

print(paste("The Zodiac Killer is", suspect_final$Name))
```
